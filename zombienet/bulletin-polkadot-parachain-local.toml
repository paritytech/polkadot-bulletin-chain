# To run the network, execute the following command:
#
# cd <root dir>
# ./scripts/create_bulletin_polkadot_parachain_spec.sh
# POLKADOT_BINARY_PATH=~/local_bulletin_testing/bin/polkadot POLKADOT_PARACHAIN_BINARY_PATH=~/local_bulletin_testing/bin/polkadot-omni-node zombienet -p native spawn ./zombienet/bulletin-polkadot-parachain-local.toml
# NOTE: The polkadot native runtime was removed from the polkadot binary, so we
# provide a pre-generated relay chain spec built from the polkadot-fellows/runtimes
# fast-runtime WASM (checked in at integration-tests/production-runtimes/).
# Run scripts/create_polkadot_relay_spec.sh to generate the spec from it.

[settings]
node_spawn_timeout = 240

[relaychain]
default_command = "{{POLKADOT_BINARY_PATH}}"
default_args = ["-lruntime=debug,xcm=trace"]
chain = "polkadot-local"
chain_spec_path = "./zombienet/polkadot-local-relay-spec.json"

[[relaychain.nodes]]
name = "alice"
validator = true
p2p_port = 30333
rpc_port = 9942
balance = 2000000000000
# WebSocket P2P on p2p_port + 1 for smoldot light client support
args = ["--listen-addr", "/ip4/0.0.0.0/tcp/30334/ws"]

[[relaychain.nodes]]
name = "bob"
validator = true
p2p_port = 30433
rpc_port = 9943
balance = 2000000000000
# WebSocket P2P on p2p_port + 1 for smoldot light client support
args = ["--listen-addr", "/ip4/0.0.0.0/tcp/30434/ws"]

[[parachains]]
id = 1006
chain_spec_path = "./zombienet/bulletin-polkadot-parachain-spec.json"
cumulus_based = true

# NOTE: Collator names match the westend config to ensure the same deterministic
# peer IDs are generated by zombienet, which is required for IPFS peer connectivity.
[[parachains.collators]]
name = "bulletin-westend-collator-1"
command = "{{POLKADOT_PARACHAIN_BINARY_PATH}}"
validator = true
p2p_port = 10001
rpc_port = 10000
args = [
	"--ipfs-server",
	# Increase tx pool from 20->64 MiB
	# "--pool-kbytes 65536",
	"-lparachain=info,runtime=debug,xcm=trace,sub-libp2p::bitswap=trace,runtime::transaction-storage=trace",
	# WebSocket P2P on p2p_port + 1 for smoldot light client support
	"--listen-addr=/ip4/0.0.0.0/tcp/10001",
	"--listen-addr=/ip4/0.0.0.0/tcp/10002/ws",
]

[[parachains.collators]]
name = "bulletin-westend-collator-2"
command = "{{POLKADOT_PARACHAIN_BINARY_PATH}}"
validator = true
p2p_port = 12347
rpc_port = 12346
args = [
	"--ipfs-server",
	# Increase tx pool from 20->64 MiB
	# "--pool-kbytes 65536",
	"-lparachain=info,runtime=debug,xcm=trace,bitswap=trace,sub-libp2p::bitswap=trace,runtime::transaction-storage=trace",
	# WebSocket P2P on p2p_port + 1 for smoldot light client support
	"--listen-addr=/ip4/0.0.0.0/tcp/12347",
	"--listen-addr=/ip4/0.0.0.0/tcp/12348/ws",
]
